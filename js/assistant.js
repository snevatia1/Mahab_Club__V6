export class Assistant{constructor(o,m,i,s){this.out=document.getElementById(o);this.input=document.getElementById(i);this.sendBtn=document.getElementById(s);this.micBtn=document.getElementById(m);this.bind();this.say('Hello! I can help you check availability and pick rooms. You can speak or type.')}bind(){if(this.sendBtn)this.sendBtn.addEventListener('click',()=>this.onUser(this.input.value));if(this.input)this.input.addEventListener('keydown',e=>{if(e.key==='Enter'){this.onUser(this.input.value)}});if(this.micBtn)this.micBtn.addEventListener('click',()=>this.listen())}card(h){const d=document.createElement('div');d.className='card';d.innerHTML=h;this.out.appendChild(d);this.out.scrollTop=this.out.scrollHeight}say(t){this.card(`<strong>Assistant:</strong> ${t}`);try{const u=new SpeechSynthesisUtterance(t);window.speechSynthesis.speak(u)}catch(e){}}onUser(t){if(!t)return;this.card(`<strong>You:</strong> ${t}`);this.input.value='';if(/split|change/i.test(t)){this.say("If the same room isn't free throughout, I can reserve a different room for some nights and the Club will shift your luggage.");return}if(/book|reserve|confirm/i.test(t)){this.say('In LIVE, I will take OTP and confirm; this TEST build prepares your selection.');return}if(/availability|free|rooms/i.test(t)){this.say('Pick your dates and click “Check Availability”. Then click a date to see room numbers and choose.');return}this.say('Pick dates, set counts, then Check Availability. You can filter FREE rooms by block under the results.')}listen(){try{const SR=window.SpeechRecognition||window.webkitSpeechRecognition;if(!SR){this.say('Voice input is not supported in this browser.');return}const r=new SR();r.lang='en-IN';r.interimResults=false;this.say('Listening...');r.onresult=e=>{const t=e.results[0][0].transcript;this.onUser(t)};r.onerror=()=>this.say('Sorry, I could not hear that.');r.start()}catch(e){this.say('Voice input not available. Please type.')}}}